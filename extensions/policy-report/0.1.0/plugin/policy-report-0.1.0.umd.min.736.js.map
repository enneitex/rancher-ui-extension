{"version":3,"file":"policy-report-0.1.0.umd.min.736.js","mappings":"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","sources":["webpack://policy-report-0.1.0/./.shell/assets/brand/ sync ^\\.\\/.*\\/metadata\\.json$","webpack://policy-report-0.1.0/./config/table-headers.ts","webpack://policy-report-0.1.0/./components/PolicyReporter/ResourceTab.vue?48fa","webpack://policy-report-0.1.0/./components/PolicyReporter/ResourceTab.vue","webpack://policy-report-0.1.0/./components/PolicyReporter/ResourceTab.vue?cf38","webpack://policy-report-0.1.0/./components/PolicyReporter/ResourceTab.vue?64c7","webpack://policy-report-0.1.0/./components/PolicyReporter/ResourceTab.vue?c8f6","webpack://policy-report-0.1.0/./.shell/promptRemove/ sync ^\\.\\/.*$"],"sourcesContent":["var map = {\n\t\"./classic/metadata.json\": 9621,\n\t\"./csp/metadata.json\": 6471,\n\t\"./federal/metadata.json\": 1862,\n\t\"./harvester/metadata.json\": 1507,\n\t\"./rgs/metadata.json\": 8401,\n\t\"./suse/metadata.json\": 7259\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1177;","export const POLICY_REPORTER_HEADERS = [\n  {\n    name:     'policy',\n    labelKey: 'policyReport.headers.policyReportsTab.policy.label',\n    value:    'policy',\n    sort:     'policy'\n  },\n  {\n    name:      'severity',\n    labelKey:  'policyReport.headers.policyReportsTab.severity.label',\n    value:     'severity',\n    sort:      'severitySort',\n    align:     'center'\n  },\n  {\n    name:      'status',\n    labelKey:  'policyReport.headers.policyReportsTab.status.label',\n    value:     'status',\n    sort:      'result',\n    align:     'center'\n  }\n];\n\nexport const POLICY_REPORTER_GROUP_OPTIONS = [\n  {\n    value:      'none',\n    icon:       'icon-list-flat',\n    tooltipKey: 'policyReport.grouping.none'\n  },\n  {\n    value:         'severity',\n    icon:          'icon-warning',\n    field:         'severity',\n    hideColumn:    'severity',\n    groupLabelKey: 'severity',\n    tooltipKey:    'policyReport.grouping.severity'\n  },\n  {\n    value:         'result',\n    icon:          'icon-checkmark',\n    field:         'result',\n    hideColumn:    'status',\n    groupLabelKey: 'result',\n    tooltipKey:    'policyReport.grouping.status'\n  }\n];\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, toDisplayString as _toDisplayString, createVNode as _createVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives, withCtx as _withCtx, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  \"data-testid\": \"resource-tab-loading\",\n  class: \"pr-tab__loading\"\n}\nconst _hoisted_2 = {\n  key: 1,\n  class: \"pr-tab__container\"\n}\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { class: \"text-center\" }\nconst _hoisted_5 = { class: \"text-center\" }\nconst _hoisted_6 = {\n  key: 0,\n  class: \"group-tab\"\n}\nconst _hoisted_7 = {\n  key: 1,\n  class: \"group-tab\"\n}\nconst _hoisted_8 = [\"colspan\"]\nconst _hoisted_9 = { class: \"text-muted\" }\nconst _hoisted_10 = { class: \"details\" }\nconst _hoisted_11 = { class: \"col\" }\nconst _hoisted_12 = { class: \"title\" }\nconst _hoisted_13 = { class: \"col\" }\nconst _hoisted_14 = { class: \"title\" }\nconst _hoisted_15 = { class: \"col\" }\nconst _hoisted_16 = { class: \"title\" }\n\nimport {\n  ref, reactive, computed, onMounted, nextTick, getCurrentInstance\n} from 'vue';\nimport { useStore } from 'vuex';\nimport { RouteLocationNormalizedLoaded } from 'vue-router';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { NAMESPACE } from '@shell/config/query-params';\n\nimport { BadgeState } from '@components/BadgeState';\nimport { Banner } from '@components/Banner';\nimport ResourceTable from '@shell/components/ResourceTable';\n\nimport { PolicyReport, PolicyReportResult, ClusterPolicyReport } from '../../types';\nimport { POLICY_REPORTER_HEADERS, POLICY_REPORTER_GROUP_OPTIONS } from '../../config/table-headers';\nimport {\n  getFilteredReport,\n  colorForResult,\n  colorForSeverity,\n  severitySortValue\n} from '../../modules/policyReporter';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ResourceTab',\n  setup(__props) {\n\nconst store = useStore();\nlet route: RouteLocationNormalizedLoaded | null = null;\n\nconst t = store.getters['i18n/t'];\n\nconst report = ref<PolicyReport | ClusterPolicyReport | null>(null);\nconst resource = ref<any>(null);\nconst headers = POLICY_REPORTER_HEADERS;\nconst groupOptions = POLICY_REPORTER_GROUP_OPTIONS;\n// Fake schema to prevent extension columns injection\nconst fakeSchema = { id: 'policy-report-result', type: 'schema' };\n\nconst fetchState = reactive({ pending: true });\n\nconst isNamespaceResource = computed(() => resource.value?.type === NAMESPACE);\n\n// Enrich report results with sort values for proper table sorting\nconst enrichedResults = computed(() => {\n  if (!report.value?.results) {\n    return [];\n  }\n\n  return report.value.results.map((row, index) => ({\n    ...row,\n    severitySort: severitySortValue(row.severity),\n    uniqueKey: `${row.policy}-${row.rule || index}`\n  }));\n});\n\nfunction determineResource() {\n  if (route?.params?.resource && route?.params?.id) {\n    const id = route?.params.namespace ? `${ route?.params.namespace }/${ route?.params.id }` : route?.params.id;\n\n    resource.value = store.getters['cluster/byId'](route?.params.resource, id);\n  }\n}\n\nasync function fetchReports() {\n  if (resource.value) {\n    fetchState.pending = true;\n    report.value  = await getFilteredReport(store, resource.value);\n  }\n\n  fetchState.pending = false;\n}\n\nfunction getResourceValue(row: PolicyReportResult, val: string, needScope = false): string {\n  if (isNamespaceResource.value && needScope) {\n    if (row.scope && val in row.scope) {\n      const value = row.scope[val as keyof typeof row.scope];\n\n      return typeof value === 'string' ? value : '-';\n    }\n\n    return '-';\n  }\n\n  if (!isEmpty(row)) {\n    if (val in row) {\n      const value = row[val as keyof (PolicyReportResult)];\n\n      return typeof value === 'string' ? value : '-';\n    }\n  }\n\n  return '-';\n}\n\nfunction severityColor(row: PolicyReportResult) {\n  if (row.result && row.severity) {\n    return colorForSeverity(row.severity);\n  }\n\n  return 'bg-muted';\n}\n\nfunction statusColor(row: PolicyReportResult) {\n  if (row.result) {\n    const color = colorForResult(row.result);\n    const bgColor = color.includes('sizzle') ? `${ color }-bg` : color.replace(/text-/, 'bg-');\n\n    return bgColor;\n  }\n\n  return 'bg-muted';\n}\n\nfunction formattedDisplayName(displayName: string): string {\n  return displayName\n    .replace(/^clusterwide-/, '') // Remove 'clusterwide-' prefix\n    .replace(/^namespaced-[^-]+-/, ''); // Remove 'namespaced-<namespace>-' prefix\n};\n\nonMounted(async() => {\n  // Ensure Vue Router is initialized before accessing `useRoute()`\n  if (!route) {\n    const instance = getCurrentInstance();\n\n    if (instance?.proxy?.$route) {\n      route = instance.proxy.$route;\n    } else {\n      return;\n    }\n  }\n\n  determineResource();\n\n  await nextTick();\n  await fetchReports();\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _directive_clean_html = _resolveDirective(\"clean-html\")!\n\n  return (fetchState.pending)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, _cache[0] || (_cache[0] = [\n        _createElementVNode(\"i\", { class: \"icon icon-lg icon-spinner icon-spin m-20\" }, null, -1)\n      ])))\n    : (!fetchState.pending && enrichedResults.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createVNode(_unref(ResourceTable), {\n            schema: fakeSchema,\n            rows: enrichedResults.value,\n            headers: _unref(headers),\n            namespaced: false,\n            \"table-actions\": false,\n            \"row-actions\": false,\n            \"key-field\": \"uniqueKey\",\n            groupable: true,\n            \"group-options\": _unref(groupOptions),\n            \"sub-expandable\": true,\n            \"sub-expand-column\": true,\n            \"sub-rows\": true\n          }, {\n            \"col:policy\": _withCtx(({ row }) => [\n              (row.policy)\n                ? (_openBlock(), _createElementBlock(\"td\", _hoisted_3, [\n                    _createElementVNode(\"span\", null, _toDisplayString(formattedDisplayName(row.policy)), 1)\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            \"col:severity\": _withCtx(({ row }) => [\n              _createElementVNode(\"td\", _hoisted_4, [\n                _createVNode(_unref(BadgeState), {\n                  label: getResourceValue(row, 'severity'),\n                  color: severityColor(row)\n                }, null, 8, [\"label\", \"color\"])\n              ])\n            ]),\n            \"col:status\": _withCtx(({ row }) => [\n              _createElementVNode(\"td\", _hoisted_5, [\n                _createVNode(_unref(BadgeState), {\n                  label: getResourceValue(row, 'result'),\n                  color: statusColor(row)\n                }, null, 8, [\"label\", \"color\"])\n              ])\n            ]),\n            \"group-by\": _withCtx(({ group }) => [\n              (group && group.key)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, _toDisplayString(group.key === 'severity' ? _unref(t)('policyReport.headers.policyReportsTab.severity.label') : _unref(t)('policyReport.headers.policyReportsTab.status.label')) + \": \" + _toDisplayString(group.ref || group.key), 1))\n                : _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_7, null, 512)), [\n                    [_directive_clean_html, group?.ref || '']\n                  ])\n            ]),\n            \"sub-row\": _withCtx(({ row, fullColspan }) => [\n              _createElementVNode(\"td\", {\n                colspan: fullColspan,\n                class: \"pr-tab__sub-row\"\n              }, [\n                (row.message)\n                  ? (_openBlock(), _createBlock(_unref(Banner), {\n                      key: 0,\n                      color: \"info\",\n                      class: \"message\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(_unref(t)('policyReport.headers.policyReportsTab.message.title')) + \": \", 1),\n                        _createElementVNode(\"span\", null, _toDisplayString(row.message), 1)\n                      ]),\n                      _: 2\n                    }, 1024))\n                  : _createCommentVNode(\"\", true),\n                _createElementVNode(\"div\", _hoisted_10, [\n                  _createElementVNode(\"section\", _hoisted_11, [\n                    _createElementVNode(\"div\", _hoisted_12, _toDisplayString(_unref(t)('policyReport.headers.policyReportsTab.source')), 1),\n                    _createElementVNode(\"span\", null, _toDisplayString(row.source || '-'), 1)\n                  ]),\n                  _createElementVNode(\"section\", _hoisted_13, [\n                    _createElementVNode(\"div\", _hoisted_14, _toDisplayString(_unref(t)('policyReport.headers.policyReportsTab.category')), 1),\n                    _createElementVNode(\"span\", null, _toDisplayString(row.category || '-'), 1)\n                  ]),\n                  _createElementVNode(\"section\", _hoisted_15, [\n                    _createElementVNode(\"div\", _hoisted_16, _toDisplayString(_unref(t)('policyReport.headers.policyReportsTab.rule')), 1),\n                    _createElementVNode(\"span\", null, _toDisplayString(row.rule || '-'), 1)\n                  ])\n                ])\n              ], 8, _hoisted_8)\n            ]),\n            _: 1\n          }, 8, [\"rows\", \"headers\", \"group-options\"])\n        ]))\n      : _createCommentVNode(\"\", true)\n}\n}\n\n})","<script setup lang=\"ts\">\nimport {\n  ref, reactive, computed, onMounted, nextTick, getCurrentInstance\n} from 'vue';\nimport { useStore } from 'vuex';\nimport { RouteLocationNormalizedLoaded } from 'vue-router';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { NAMESPACE } from '@shell/config/query-params';\n\nimport { BadgeState } from '@components/BadgeState';\nimport { Banner } from '@components/Banner';\nimport ResourceTable from '@shell/components/ResourceTable';\n\nimport { PolicyReport, PolicyReportResult, ClusterPolicyReport } from '../../types';\nimport { POLICY_REPORTER_HEADERS, POLICY_REPORTER_GROUP_OPTIONS } from '../../config/table-headers';\nimport {\n  getFilteredReport,\n  colorForResult,\n  colorForSeverity,\n  severitySortValue\n} from '../../modules/policyReporter';\n\nconst store = useStore();\nlet route: RouteLocationNormalizedLoaded | null = null;\n\nconst t = store.getters['i18n/t'];\n\nconst report = ref<PolicyReport | ClusterPolicyReport | null>(null);\nconst resource = ref<any>(null);\nconst headers = POLICY_REPORTER_HEADERS;\nconst groupOptions = POLICY_REPORTER_GROUP_OPTIONS;\n// Fake schema to prevent extension columns injection\nconst fakeSchema = { id: 'policy-report-result', type: 'schema' };\n\nconst fetchState = reactive({ pending: true });\n\nconst isNamespaceResource = computed(() => resource.value?.type === NAMESPACE);\n\n// Enrich report results with sort values for proper table sorting\nconst enrichedResults = computed(() => {\n  if (!report.value?.results) {\n    return [];\n  }\n\n  return report.value.results.map((row, index) => ({\n    ...row,\n    severitySort: severitySortValue(row.severity),\n    uniqueKey: `${row.policy}-${row.rule || index}`\n  }));\n});\n\nfunction determineResource() {\n  if (route?.params?.resource && route?.params?.id) {\n    const id = route?.params.namespace ? `${ route?.params.namespace }/${ route?.params.id }` : route?.params.id;\n\n    resource.value = store.getters['cluster/byId'](route?.params.resource, id);\n  }\n}\n\nasync function fetchReports() {\n  if (resource.value) {\n    fetchState.pending = true;\n    report.value  = await getFilteredReport(store, resource.value);\n  }\n\n  fetchState.pending = false;\n}\n\nfunction getResourceValue(row: PolicyReportResult, val: string, needScope = false): string {\n  if (isNamespaceResource.value && needScope) {\n    if (row.scope && val in row.scope) {\n      const value = row.scope[val as keyof typeof row.scope];\n\n      return typeof value === 'string' ? value : '-';\n    }\n\n    return '-';\n  }\n\n  if (!isEmpty(row)) {\n    if (val in row) {\n      const value = row[val as keyof (PolicyReportResult)];\n\n      return typeof value === 'string' ? value : '-';\n    }\n  }\n\n  return '-';\n}\n\nfunction severityColor(row: PolicyReportResult) {\n  if (row.result && row.severity) {\n    return colorForSeverity(row.severity);\n  }\n\n  return 'bg-muted';\n}\n\nfunction statusColor(row: PolicyReportResult) {\n  if (row.result) {\n    const color = colorForResult(row.result);\n    const bgColor = color.includes('sizzle') ? `${ color }-bg` : color.replace(/text-/, 'bg-');\n\n    return bgColor;\n  }\n\n  return 'bg-muted';\n}\n\nfunction formattedDisplayName(displayName: string): string {\n  return displayName\n    .replace(/^clusterwide-/, '') // Remove 'clusterwide-' prefix\n    .replace(/^namespaced-[^-]+-/, ''); // Remove 'namespaced-<namespace>-' prefix\n};\n\nonMounted(async() => {\n  // Ensure Vue Router is initialized before accessing `useRoute()`\n  if (!route) {\n    const instance = getCurrentInstance();\n\n    if (instance?.proxy?.$route) {\n      route = instance.proxy.$route;\n    } else {\n      return;\n    }\n  }\n\n  determineResource();\n\n  await nextTick();\n  await fetchReports();\n});\n</script>\n\n<template>\n  <div v-if=\"fetchState.pending\" data-testid=\"resource-tab-loading\" class=\"pr-tab__loading\">\n    <i class=\"icon icon-lg icon-spinner icon-spin  m-20\" />\n  </div>\n  <div v-else-if=\"!fetchState.pending && enrichedResults\" class=\"pr-tab__container\">\n    <ResourceTable\n      :schema=\"fakeSchema\"\n      :rows=\"enrichedResults\"\n      :headers=\"headers\"\n      :namespaced=\"false\"\n      :table-actions=\"false\"\n      :row-actions=\"false\"\n      key-field=\"uniqueKey\"\n      :groupable=\"true\"\n      :group-options=\"groupOptions\"\n      :sub-expandable=\"true\"\n      :sub-expand-column=\"true\"\n      :sub-rows=\"true\"\n    >\n      <template #col:policy=\"{ row }\">\n        <td v-if=\"row.policy\">\n          <span>{{ formattedDisplayName(row.policy) }}</span>\n        </td>\n      </template>\n      <template #col:severity=\"{ row }\">\n        <td class=\"text-center\">\n          <BadgeState\n            :label=\"getResourceValue(row, 'severity')\"\n            :color=\"severityColor(row)\"\n          />\n        </td>\n      </template>\n      <template #col:status=\"{ row }\">\n        <td class=\"text-center\">\n          <BadgeState\n            :label=\"getResourceValue(row, 'result')\"\n            :color=\"statusColor(row)\"\n          />\n        </td>\n      </template>\n\n      <!-- Custom group-by header with colored badges -->\n      <template #group-by=\"{ group }\">\n        <div\n          v-if=\"group && group.key\"\n          class=\"group-tab\"\n        >\n          {{ group.key === 'severity' ? t('policyReport.headers.policyReportsTab.severity.label') : t('policyReport.headers.policyReportsTab.status.label') }}: {{ group.ref || group.key }}\n        </div>\n        <div\n          v-else\n          v-clean-html=\"group?.ref || ''\"\n          class=\"group-tab\"\n        />\n      </template>\n\n      <!-- Sub-rows -->\n      <template #sub-row=\"{ row, fullColspan }\">\n        <td :colspan=\"fullColspan\" class=\"pr-tab__sub-row\">\n          <Banner v-if=\"row.message\" color=\"info\" class=\"message\">\n            <span class=\"text-muted\">\n              {{ t('policyReport.headers.policyReportsTab.message.title') }}:\n            </span>\n            <span>{{ row.message }}</span>\n          </Banner>\n          <div class=\"details\">\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('policyReport.headers.policyReportsTab.source') }}\n              </div>\n              <span>{{ row.source || '-' }}</span>\n            </section>\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('policyReport.headers.policyReportsTab.category') }}\n              </div>\n              <span>{{ row.category || '-' }}</span>\n            </section>\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('policyReport.headers.policyReportsTab.rule') }}\n              </div>\n              <span>{{ row.rule || '-' }}</span>\n            </section>\n          </div>\n        </td>\n      </template>\n    </ResourceTable>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n$error: #614EA2;\n\n// Need to override the default colors for these classes\n.pr-tab {\n  &__loading {\n    display: flex;\n    justify-content: center;\n  }\n\n  &__container {\n    .sizzle-warning-bg {\n      background-color: $error;\n      color: #fff;\n    }\n\n    .text-warning {\n      color: var(--warning) !important;\n    }\n\n    .text-darker {\n      color: var(--dark) !important;\n    }\n\n    .sizzle-warning {\n      color: $error;\n    }\n  }\n\n  &__sub-row {\n    background-color: var(--body-bg);\n    border-bottom: 1px solid var(--sortable-table-top-divider);\n    padding-left: 1rem;\n    padding-right: 1rem;\n\n    .message {\n      display: flex;\n      flex-direction: column;\n    }\n\n    .details {\n      display: flex;\n      flex-direction: row;\n\n      .col {\n        display: flex;\n        flex-direction: column;\n\n        section {\n          margin-bottom: 1.5rem;\n        }\n\n        .title {\n          color: var(--muted);\n          margin-bottom: 0.5rem;\n        }\n      }\n    }\n  }\n}\n\n</style>\n","import script from \"./ResourceTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ResourceTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ResourceTab.vue?vue&type=style&index=0&id=0a5ae235&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0a5ae235\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".pr-tab__loading[data-v-0a5ae235]{display:flex;justify-content:center}.pr-tab__container .sizzle-warning-bg[data-v-0a5ae235]{background-color:#614ea2;color:#fff}.pr-tab__container .text-warning[data-v-0a5ae235]{color:var(--warning)!important}.pr-tab__container .text-darker[data-v-0a5ae235]{color:var(--dark)!important}.pr-tab__container .sizzle-warning[data-v-0a5ae235]{color:#614ea2}.pr-tab__sub-row[data-v-0a5ae235]{background-color:var(--body-bg);border-bottom:1px solid var(--sortable-table-top-divider);padding-left:1rem;padding-right:1rem}.pr-tab__sub-row .message[data-v-0a5ae235]{display:flex;flex-direction:column}.pr-tab__sub-row .details[data-v-0a5ae235]{display:flex;flex-direction:row}.pr-tab__sub-row .details .col[data-v-0a5ae235]{display:flex;flex-direction:column}.pr-tab__sub-row .details .col section[data-v-0a5ae235]{margin-bottom:1.5rem}.pr-tab__sub-row .details .col .title[data-v-0a5ae235]{color:var(--muted);margin-bottom:.5rem}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ResourceTab.vue?vue&type=style&index=0&id=0a5ae235&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"69ed507c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var map = {\n\t\"./management.cattle.io.fleetworkspace\": 5593,\n\t\"./management.cattle.io.fleetworkspace.vue\": 5593,\n\t\"./management.cattle.io.globalrole\": 9126,\n\t\"./management.cattle.io.globalrole.vue\": 9126,\n\t\"./management.cattle.io.project\": 1193,\n\t\"./management.cattle.io.project.vue\": 1193,\n\t\"./management.cattle.io.roletemplate\": 4093,\n\t\"./management.cattle.io.roletemplate.vue\": 4093,\n\t\"./mixin/roleDeletionCheck\": 1277,\n\t\"./mixin/roleDeletionCheck.js\": 1277,\n\t\"./pod\": 4563,\n\t\"./pod.vue\": 4563\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 9989;"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","POLICY_REPORTER_HEADERS","name","labelKey","value","sort","align","POLICY_REPORTER_GROUP_OPTIONS","icon","tooltipKey","field","hideColumn","groupLabelKey","_hoisted_1","key","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_defineComponent","__name","setup","__props","store","useStore","route","t","getters","report","ref","resource","headers","groupOptions","fakeSchema","type","fetchState","reactive","pending","isNamespaceResource","computed","NAMESPACE","enrichedResults","results","row","index","severitySort","severitySortValue","severity","uniqueKey","policy","rule","determineResource","params","namespace","async","fetchReports","getFilteredReport","getResourceValue","val","needScope","scope","isEmpty","severityColor","result","colorForSeverity","statusColor","color","colorForResult","bgColor","includes","replace","formattedDisplayName","displayName","onMounted","instance","getCurrentInstance","proxy","$route","nextTick","_ctx","_cache","_directive_clean_html","_resolveDirective","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_unref","ResourceTable","schema","rows","namespaced","groupable","_withCtx","_toDisplayString","_createCommentVNode","BadgeState","label","group","_withDirectives","fullColspan","colspan","message","_createBlock","Banner","default","_","source","category","__exports__","___CSS_LOADER_EXPORT___","push","content","__esModule","locals","add"],"sourceRoot":""}